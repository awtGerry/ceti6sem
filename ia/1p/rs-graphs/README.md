Trying the same algorithm with rust.

It may need some fixes.
